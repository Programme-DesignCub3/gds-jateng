import{d as we,x as re,H as Xe,o as k,c as C,b as u,s as he,u as b,f as _,F as fe,e as pe,j as B,t as se,I as qe,J as Ge,Q as Ke,T as Je,K as Ye,k as Ze,y as Qe,h as et,w as x,Z as tt,i as nt,g as I,L as rt,l as st,D as it}from"./app-BMqql4sf.js";import{_ as j,F as at,a as ot,V as ut}from"./VideoUpload.vue_vue_type_style_index_0_scoped_e02c70d7_lang-BSC2KSFW.js";import{_ as me}from"./Input.vue_vue_type_script_setup_true_lang-qWzFAclx.js";import{_ as lt}from"./Textarea.vue_vue_type_script_setup_true_lang-Dizd_pTF.js";import{_ as ct}from"./AppLayout.vue_vue_type_script_setup_true_lang-BjptPQff.js";import{u as dt,C as ht,_ as ft}from"./ScrollArea.vue_vue_type_script_setup_true_lang-D2F3Ght6.js";import{_ as pt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-DvRUfhyl.js";import"./index-Ddcp25Iv.js";import"./utils-z192C6H7.js";import"./ApplicationLogo-7upNAe30.js";const ae=e=>(qe("data-v-e02c70d7"),e=e(),Ge(),e),mt={class:"text-center"},gt={class:"mx-auto max-w-min rounded-md border p-2"},vt=ae(()=>u("p",{class:"mt-2 text-sm text-gray-600"},"Masih WIP, ALIAS BELUM WORK 100%",-1)),yt={key:0},bt={key:1,class:"mt-2 text-sm text-gray-600"},_t=ae(()=>u("span",{class:"font-semibold"},"Drag files",-1)),kt=[_t],Ct=ae(()=>u("p",{class:"text-xs text-gray-500"}," Click to upload files (files should be under 250MB) ",-1)),St={key:0,class:"text-sm"},wt=we({__name:"VideoUpload",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(e){const t=re(null),n=Xe(e,"modelValue"),r=async(l,f)=>{if(n.value=l[0],f.length){t.value=f;return}t.value=null},{getRootProps:s,getInputProps:i,isDragActive:o}=dt({onDrop:r,maxFiles:1,multiple:!1,accept:"video/mp4",maxSize:250*1024*1024});return(l,f)=>(k(),C("div",null,[u("div",null,[u("label",he(b(s)(),{class:"relative flex w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 py-6 hover:bg-gray-100"}),[u("div",mt,[u("div",gt,[_(b(ht),{size:20})]),vt,b(o)?(k(),C("p",yt,"Drop the files here ...")):(k(),C("p",bt,kt)),Ct])],16),t.value?(k(),C("div",St,[(k(!0),C(fe,null,pe(t.value,c=>(k(),C("ul",null,[(k(!0),C(fe,null,pe(c.errors,h=>(k(),C("li",null,[u("p",null,se(h),1)]))),256))]))),256))])):B("",!0)]),u("input",he(b(i)(),{id:"dropzone-file",accept:"video/*",type:"file",class:"hidden"}),null,16)]))}}),Et=pt(wt,[["__scopeId","data-v-e02c70d7"]]);var Rt=Object.create,Ee=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,Re=Object.getOwnPropertyNames,xt=Object.getPrototypeOf,Tt=Object.prototype.hasOwnProperty,F=(e,t)=>function(){return t||(0,e[Re(e)[0]])((t={exports:{}}).exports,t),t.exports},Pt=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Re(t))!Tt.call(e,s)&&s!==n&&Ee(e,s,{get:()=>t[s],enumerable:!(r=zt(t,s))||r.enumerable});return e},Ot=(e,t,n)=>(n=e!=null?Rt(xt(e)):{},Pt(!e||!e.__esModule?Ee(n,"default",{value:e,enumerable:!0}):n,e)),It=F({"node_modules/global/window.js"(e,t){var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n={},t.exports=n}}),At=F({"node_modules/is-function/index.js"(e,t){t.exports=r;var n=Object.prototype.toString;function r(s){if(!s)return!1;var i=n.call(s);return i==="[object Function]"||typeof s=="function"&&i!=="[object RegExp]"||typeof window<"u"&&(s===window.setTimeout||s===window.alert||s===window.confirm||s===window.prompt)}}}),Bt=F({"node_modules/parse-headers/parse-headers.js"(e,t){var n=function(s){return s.replace(/^\s+|\s+$/g,"")},r=function(s){return Object.prototype.toString.call(s)==="[object Array]"};t.exports=function(s){if(!s)return{};for(var i={},o=n(s).split(`
`),l=0;l<o.length;l++){var f=o[l],c=f.indexOf(":"),h=n(f.slice(0,c)).toLowerCase(),y=n(f.slice(c+1));typeof i[h]>"u"?i[h]=y:r(i[h])?i[h].push(y):i[h]=[i[h],y]}return i}}}),Lt=F({"node_modules/xtend/immutable.js"(e,t){t.exports=r;var n=Object.prototype.hasOwnProperty;function r(){for(var s={},i=0;i<arguments.length;i++){var o=arguments[i];for(var l in o)n.call(o,l)&&(s[l]=o[l])}return s}}}),jt=F({"node_modules/xhr/index.js"(e,t){var n=It(),r=At(),s=Bt(),i=Lt();t.exports=c,t.exports.default=c,c.XMLHttpRequest=n.XMLHttpRequest||S,c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:n.XDomainRequest,o(["get","put","post","patch","head","delete"],function(a){c[a==="delete"?"del":a]=function(p,v,z){return v=f(p,v,z),v.method=a.toUpperCase(),h(v)}});function o(a,p){for(var v=0;v<a.length;v++)p(a[v])}function l(a){for(var p in a)if(a.hasOwnProperty(p))return!1;return!0}function f(a,p,v){var z=a;return r(p)?(v=p,typeof a=="string"&&(z={uri:a})):z=i(p,{uri:a}),z.callback=v,z}function c(a,p,v){return p=f(a,p,v),h(p)}function h(a){if(typeof a.callback>"u")throw new Error("callback argument missing");var p=!1,v=function(O,V,We){p||(p=!0,a.callback(O,V,We))};function z(){d.readyState===4&&setTimeout(le,0)}function Ve(){var m=void 0;if(d.response?m=d.response:m=d.responseText||y(d),ce)try{m=JSON.parse(m)}catch{}return m}function G(m){return clearTimeout(Z),m instanceof Error||(m=new Error(""+(m||"Unknown XMLHttpRequest Error"))),m.statusCode=0,v(m,de)}function le(){if(!H){var m;clearTimeout(Z),a.useXDR&&d.status===void 0?m=200:m=d.status===1223?204:d.status;var O=de,V=null;return m!==0?(O={body:Ve(),statusCode:m,method:L,headers:{},url:K,rawRequest:d},d.getAllResponseHeaders&&(O.headers=s(d.getAllResponseHeaders()))):V=new Error("Internal XMLHttpRequest Error"),v(V,O,O.body)}}var d=a.xhr||null;d||(a.cors||a.useXDR?d=new c.XDomainRequest:d=new c.XMLHttpRequest);var $,H,K=d.url=a.uri||a.url,L=d.method=a.method||"GET",J=a.body||a.data,E=d.headers=a.headers||{},Y=!!a.sync,ce=!1,Z,de={body:void 0,headers:{},statusCode:0,method:L,url:K,rawRequest:d};if("json"in a&&a.json!==!1&&(ce=!0,E.accept||E.Accept||(E.Accept="application/json"),L!=="GET"&&L!=="HEAD"&&(E["content-type"]||E["Content-Type"]||(E["Content-Type"]="application/json"),J=JSON.stringify(a.json===!0?J:a.json))),d.onreadystatechange=z,d.onload=le,d.onerror=G,d.onprogress=function(){},d.onabort=function(){H=!0},d.ontimeout=G,d.open(L,K,!Y,a.username,a.password),Y||(d.withCredentials=!!a.withCredentials),!Y&&a.timeout>0&&(Z=setTimeout(function(){if(!H){H=!0,d.abort("timeout");var m=new Error("XMLHttpRequest timeout");m.code="ETIMEDOUT",G(m)}},a.timeout)),d.setRequestHeader)for($ in E)E.hasOwnProperty($)&&d.setRequestHeader($,E[$]);else if(a.headers&&!l(a.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in a&&(d.responseType=a.responseType),"beforeSend"in a&&typeof a.beforeSend=="function"&&a.beforeSend(d),d.send(J||null),d}function y(a){try{if(a.responseType==="document")return a.responseXML;var p=a.responseXML&&a.responseXML.documentElement.nodeName==="parsererror";if(a.responseType===""&&!p)return a.responseXML}catch{}return null}function S(){}}});function oe(e,t,...n){if(!e)throw new TypeError(ze(t,n))}function ze(e,t){let n=0;return e.replace(/%[os]/gu,()=>xe(t[n++]))}function xe(e){return typeof e!="object"||e===null?String(e):Object.prototype.toString.call(e)}var Ut;function Dt(e){try{const t=e instanceof Error?e:new Error(xe(e));if(typeof dispatchEvent=="function"&&typeof ErrorEvent=="function")dispatchEvent(new ErrorEvent("error",{error:t,message:t.message}));else if(typeof process<"u"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)}catch{}}var w=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:typeof globalThis<"u"?globalThis:void 0,Ft,P=class{constructor(e,t){this.code=e,this.message=t}warn(...e){var t;try{const n=((t=new Error().stack)!==null&&t!==void 0?t:"").replace(/^(?:.+?\n){2}/gu,`
`);console.warn(this.message,...e,n)}catch{}}},Nt=new P("W01","Unable to initialize event under dispatching."),Mt=new P("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),$t=new P("W03","Assigning any truthy value to 'returnValue' property has no effect."),Ht=new P("W04","Unable to preventDefault on non-cancelable events."),Vt=new P("W05","Unable to preventDefault inside passive event listener invocation."),Wt=new P("W06","An event listener wasn't added because it has been added already: %o, %o"),Q=new P("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),ge=new P("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),R=class{static get NONE(){return ve}static get CAPTURING_PHASE(){return ye}static get AT_TARGET(){return be}static get BUBBLING_PHASE(){return _e}constructor(e,t){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=t??{};ie.set(this,{type:String(e),bubbles:!!n.bubbles,cancelable:!!n.cancelable,composed:!!n.composed,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return g(this).type}get target(){return g(this).target}get srcElement(){return g(this).target}get currentTarget(){return g(this).currentTarget}composedPath(){const e=g(this).currentTarget;return e?[e]:[]}get NONE(){return ve}get CAPTURING_PHASE(){return ye}get AT_TARGET(){return be}get BUBBLING_PHASE(){return _e}get eventPhase(){return g(this).dispatchFlag?2:0}stopPropagation(){g(this).stopPropagationFlag=!0}get cancelBubble(){return g(this).stopPropagationFlag}set cancelBubble(e){e?g(this).stopPropagationFlag=!0:Mt.warn()}stopImmediatePropagation(){const e=g(this);e.stopPropagationFlag=e.stopImmediatePropagationFlag=!0}get bubbles(){return g(this).bubbles}get cancelable(){return g(this).cancelable}get returnValue(){return!g(this).canceledFlag}set returnValue(e){e?$t.warn():ke(g(this))}preventDefault(){ke(g(this))}get defaultPrevented(){return g(this).canceledFlag}get composed(){return g(this).composed}get isTrusted(){return!1}get timeStamp(){return g(this).timeStamp}initEvent(e,t=!1,n=!1){const r=g(this);if(r.dispatchFlag){Nt.warn();return}ie.set(this,{...r,type:String(e),bubbles:!!t,cancelable:!!n,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}},ve=0,ye=1,be=2,_e=3,ie=new WeakMap;function g(e,t="this"){const n=ie.get(e);return oe(n!=null,"'%s' must be an object that Event constructor created, but got another one: %o",t,e),n}function ke(e){if(e.inPassiveListenerFlag){Vt.warn();return}if(!e.cancelable){Ht.warn();return}e.canceledFlag=!0}Object.defineProperty(R,"NONE",{enumerable:!0});Object.defineProperty(R,"CAPTURING_PHASE",{enumerable:!0});Object.defineProperty(R,"AT_TARGET",{enumerable:!0});Object.defineProperty(R,"BUBBLING_PHASE",{enumerable:!0});var ee=Object.getOwnPropertyNames(R.prototype);for(let e=0;e<ee.length;++e)ee[e]!=="constructor"&&Object.defineProperty(R.prototype,ee[e],{enumerable:!0});typeof w<"u"&&typeof w.Event<"u"&&Object.setPrototypeOf(R.prototype,w.Event.prototype);function Xt(e){return w.DOMException?new w.DOMException(e,"InvalidStateError"):(A==null&&(A=class Te extends Error{constructor(n){super(n),Error.captureStackTrace&&Error.captureStackTrace(this,Te)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(A.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),Se(A),Se(A.prototype)),new A(e))}var A,Ce={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function Se(e){const t=Object.keys(Ce);for(let n=0;n<t.length;++n){const r=t[n],s=Ce[r];Object.defineProperty(e,r,{get(){return s},configurable:!0,enumerable:!0})}}var X=class extends R{static wrap(e){return new(Oe(e))(e)}constructor(e){super(e.type,{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}),e.cancelBubble&&super.stopPropagation(),e.defaultPrevented&&super.preventDefault(),Pe.set(this,{original:e});const t=Object.keys(e);for(let n=0;n<t.length;++n){const r=t[n];r in this||Object.defineProperty(this,r,Ie(e,r))}}stopPropagation(){super.stopPropagation();const{original:e}=T(this);"stopPropagation"in e&&e.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(e){super.cancelBubble=e;const{original:t}=T(this);"cancelBubble"in t&&(t.cancelBubble=e)}stopImmediatePropagation(){super.stopImmediatePropagation();const{original:e}=T(this);"stopImmediatePropagation"in e&&e.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(e){super.returnValue=e;const{original:t}=T(this);"returnValue"in t&&(t.returnValue=e)}preventDefault(){super.preventDefault();const{original:e}=T(this);"preventDefault"in e&&e.preventDefault()}get timeStamp(){const{original:e}=T(this);return"timeStamp"in e?e.timeStamp:super.timeStamp}},Pe=new WeakMap;function T(e){const t=Pe.get(e);return oe(t!=null,"'this' is expected an Event object, but got",e),t}var W=new WeakMap;W.set(Object.prototype,X);typeof w<"u"&&typeof w.Event<"u"&&W.set(w.Event.prototype,X);function Oe(e){const t=Object.getPrototypeOf(e);if(t==null)return X;let n=W.get(t);return n==null&&(n=qt(Oe(t),t),W.set(t,n)),n}function qt(e,t){class n extends e{}const r=Object.keys(t);for(let s=0;s<r.length;++s)Object.defineProperty(n.prototype,r[s],Ie(t,r[s]));return n}function Ie(e,t){const n=Object.getOwnPropertyDescriptor(e,t);return{get(){const r=T(this).original,s=r[t];return typeof s=="function"?s.bind(r):s},set(r){const s=T(this).original;s[t]=r},configurable:n.configurable,enumerable:n.enumerable}}function Gt(e,t,n,r,s,i){return{callback:e,flags:(t?1:0)|(n?2:0)|(r?4:0),signal:s,signalListener:i}}function Kt(e){e.flags|=8}function Ae(e){return(e.flags&1)===1}function Be(e){return(e.flags&2)===2}function Le(e){return(e.flags&4)===4}function Jt(e){return(e.flags&8)===8}function Yt({callback:e},t,n){try{typeof e=="function"?e.call(t,n):typeof e.handleEvent=="function"&&e.handleEvent(n)}catch(r){Dt(r)}}function je({listeners:e},t,n){for(let r=0;r<e.length;++r)if(e[r].callback===t&&Ae(e[r])===n)return r;return-1}function Zt(e,t,n,r,s,i){let o;i&&(o=Ue.bind(null,e,t,n),i.addEventListener("abort",o));const l=Gt(t,n,r,s,i,o);return e.cow?(e.cow=!1,e.listeners=[...e.listeners,l]):e.listeners.push(l),l}function Ue(e,t,n){const r=je(e,t,n);return r!==-1?De(e,r):!1}function De(e,t,n=!1){const r=e.listeners[t];return Kt(r),r.signal&&r.signal.removeEventListener("abort",r.signalListener),e.cow&&!n?(e.cow=!1,e.listeners=e.listeners.filter((s,i)=>i!==t),!1):(e.listeners.splice(t,1),!0)}function Qt(){return Object.create(null)}function en(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}var q=class{constructor(){Fe.set(this,Qt())}addEventListener(e,t,n){const r=te(this),{callback:s,capture:i,once:o,passive:l,signal:f,type:c}=tn(e,t,n);if(s==null||f!=null&&f.aborted)return;const h=en(r,c),y=je(h,s,i);if(y!==-1){rn(h.listeners[y],l,o,f);return}Zt(h,s,i,l,o,f)}removeEventListener(e,t,n){const r=te(this),{callback:s,capture:i,type:o}=nn(e,t,n),l=r[o];s!=null&&l&&Ue(l,s,i)}dispatchEvent(e){const t=te(this)[String(e.type)];if(t==null)return!0;const n=e instanceof R?e:X.wrap(e),r=g(n,"event");if(r.dispatchFlag)throw Xt("This event has been in dispatching.");if(r.dispatchFlag=!0,r.target=r.currentTarget=this,!r.stopPropagationFlag){const{cow:s,listeners:i}=t;t.cow=!0;for(let o=0;o<i.length;++o){const l=i[o];if(!Jt(l)&&(Le(l)&&De(t,o,!s)&&(o-=1),r.inPassiveListenerFlag=Be(l),Yt(l,this,n),r.inPassiveListenerFlag=!1,r.stopImmediatePropagationFlag))break}s||(t.cow=!1)}return r.target=null,r.currentTarget=null,r.stopImmediatePropagationFlag=!1,r.stopPropagationFlag=!1,r.dispatchFlag=!1,!r.canceledFlag}},Fe=new WeakMap;function te(e,t="this"){const n=Fe.get(e);return oe(n!=null,"'%s' must be an object that EventTarget constructor created, but got another one: %o",t,e),n}function tn(e,t,n){var r;return Ne(t),typeof n=="object"&&n!==null?{type:String(e),callback:t??void 0,capture:!!n.capture,passive:!!n.passive,once:!!n.once,signal:(r=n.signal)!==null&&r!==void 0?r:void 0}:{type:String(e),callback:t??void 0,capture:!!n,passive:!1,once:!1,signal:void 0}}function nn(e,t,n){return Ne(t),typeof n=="object"&&n!==null?{type:String(e),callback:t??void 0,capture:!!n.capture}:{type:String(e),callback:t??void 0,capture:!!n}}function Ne(e){if(!(typeof e=="function"||typeof e=="object"&&e!==null&&typeof e.handleEvent=="function")){if(e==null||typeof e=="object"){ge.warn(e);return}throw new TypeError(ze(ge.message,[e]))}}function rn(e,t,n,r){Wt.warn(Ae(e)?"capture":"bubble",e.callback),Be(e)!==t&&Q.warn("passive"),Le(e)!==n&&Q.warn("once"),e.signal!==r&&Q.warn("signal")}var ne=Object.getOwnPropertyNames(q.prototype);for(let e=0;e<ne.length;++e)ne[e]!=="constructor"&&Object.defineProperty(q.prototype,ne[e],{enumerable:!0});typeof w<"u"&&typeof w.EventTarget<"u"&&Object.setPrototypeOf(q.prototype,w.EventTarget.prototype);var sn=Ot(jt()),ue=30720,N=512e3,M=256,U=(e,{minChunkSize:t=M,maxChunkSize:n=N}={})=>e==null||typeof e=="number"&&e>=256&&e%256===0&&e>=t&&e<=n,D=(e,{minChunkSize:t=M,maxChunkSize:n=N}={})=>new TypeError(`chunkSize ${e} must be a positive number in multiples of 256, between ${t} and ${n}`),an=class{constructor(e,t={}){this.readableStream=e;var n,r,s;if(!U(t.defaultChunkSize,t))throw D(t.defaultChunkSize,t);this.defaultChunkSize=(n=t.defaultChunkSize)!=null?n:ue,this.minChunkSize=(r=t.minChunkSize)!=null?r:M,this.maxChunkSize=(s=t.maxChunkSize)!=null?s:N}get chunkSize(){var e;return(e=this._chunkSize)!=null?e:this.defaultChunkSize}set chunkSize(e){if(!U(e,this))throw D(e,this);this._chunkSize=e}get chunkByteSize(){return this.chunkSize*1024}get error(){return this._error}async*[Symbol.asyncIterator](){let e;const t=this.readableStream.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n){if(e){const i=e;e=void 0,yield i}break}const s=r instanceof Uint8Array?new Blob([r],{type:"application/octet-stream"}):r;for(e=e?new Blob([e,s]):s;e;)if(e.size===this.chunkByteSize){const i=e;e=void 0,yield i;break}else{if(e.size<this.chunkByteSize)break;{const i=e.slice(0,this.chunkByteSize);e=e.slice(this.chunkByteSize),yield i}}}}catch(n){this._error=n}finally{if(e){const n=e;e=void 0,yield n}t.releaseLock();return}}},on=class{constructor(e,t={}){this.file=e;var n,r,s;if(!U(t.defaultChunkSize,t))throw D(t.defaultChunkSize,t);this.defaultChunkSize=(n=t.defaultChunkSize)!=null?n:ue,this.minChunkSize=(r=t.minChunkSize)!=null?r:M,this.maxChunkSize=(s=t.maxChunkSize)!=null?s:N}get chunkSize(){var e;return(e=this._chunkSize)!=null?e:this.defaultChunkSize}set chunkSize(e){if(!U(e,this))throw D(e,this);this._chunkSize=e}get chunkByteSize(){return this.chunkSize*1024}get error(){return this._error}async*[Symbol.asyncIterator](){const e=new FileReader;let t=0;const n=()=>new Promise(r=>{if(t>=this.file.size){r(void 0);return}const s=Math.min(this.chunkByteSize,this.file.size-t);e.onload=()=>{e.result!==null?r(new Blob([e.result],{type:"application/octet-stream"})):r(void 0)},e.readAsArrayBuffer(this.file.slice(t,t+s))});try{for(;;){const r=await n();if(r)t+=r.size,yield r;else break}}catch(r){this._error=r}}},un=[200,201,202,204,308],Me=[408,502,503,504],ln=[308],$e=(e,t)=>!!e&&un.includes(e.statusCode),cn=(e,{retryCodes:t=Me})=>!e||t.includes(e.statusCode),dn=(e,t)=>t.attemptCount>=t.attempts||!($e(e)||cn(e,t)),hn=(e,t)=>{var n;if(!e||!ln.includes(e.statusCode)||!((n=e.headers)!=null&&n.range))return!1;const r=e.headers.range.match(/bytes=(\d+)-(\d+)/);return r?parseInt(r[2],10)!==t.currentChunkEndByte:!1},He=class{static createUpload(e){return new He(e)}constructor(e){if(this.eventTarget=new q,this.endpoint=e.endpoint,this.file=e.file,this.headers=e.headers||{},this.method=e.method||"PUT",this.attempts=e.attempts||5,this.delayBeforeAttempt=e.delayBeforeAttempt||1,this.retryCodes=e.retryCodes||Me,this.dynamicChunkSize=e.dynamicChunkSize||!1,this.maxFileBytes=(e.maxFileSize||0)*1024,this.chunkCount=0,this.attemptCount=0,this._offline=typeof window<"u"&&!window.navigator.onLine,this._paused=!1,this.success=!1,this.nextChunkRangeStart=0,e.useLargeFileWorkaround){const t=n=>{this.chunkedIterable.error&&(console.warn(`Unable to read file of size ${this.file.size} bytes via a ReadableStream. Falling back to in-memory FileReader!`),n.stopImmediatePropagation(),this.chunkedIterable=new on(this.file,{...e,defaultChunkSize:e.chunkSize}),this.chunkedIterator=this.chunkedIterable[Symbol.asyncIterator](),this.getEndpoint().then(()=>{this.sendChunks()}),this.off("error",t))};this.on("error",t)}this.chunkedIterable=new an(this.file.stream(),{...e,defaultChunkSize:e.chunkSize}),this.chunkedIterator=this.chunkedIterable[Symbol.asyncIterator](),this.totalChunks=Math.ceil(this.file.size/this.chunkByteSize),this.validateOptions(),this.getEndpoint().then(()=>this.sendChunks()),typeof window<"u"&&(window.addEventListener("online",()=>{this.offline&&(this._offline=!1,this.dispatch("online"),this.sendChunks())}),window.addEventListener("offline",()=>{this.offline||(this._offline=!0,this.dispatch("offline"))}))}get maxChunkSize(){var e,t;return(t=(e=this.chunkedIterable)==null?void 0:e.maxChunkSize)!=null?t:N}get minChunkSize(){var e,t;return(t=(e=this.chunkedIterable)==null?void 0:e.minChunkSize)!=null?t:M}get chunkSize(){var e,t;return(t=(e=this.chunkedIterable)==null?void 0:e.chunkSize)!=null?t:ue}set chunkSize(e){this.chunkedIterable.chunkSize=e}get chunkByteSize(){return this.chunkedIterable.chunkByteSize}get totalChunkSize(){return Math.ceil(this.file.size/this.chunkByteSize)}on(e,t){this.eventTarget.addEventListener(e,t)}once(e,t){this.eventTarget.addEventListener(e,t,{once:!0})}off(e,t){this.eventTarget.removeEventListener(e,t)}get offline(){return this._offline}get paused(){return this._paused}abort(){var e;this.pause(),(e=this.currentXhr)==null||e.abort()}pause(){this._paused=!0}resume(){this._paused&&(this._paused=!1,this.sendChunks())}get successfulPercentage(){return this.nextChunkRangeStart/this.file.size}dispatch(e,t){const n=new CustomEvent(e,{detail:t});this.eventTarget.dispatchEvent(n)}validateOptions(){if(!this.endpoint||typeof this.endpoint!="function"&&typeof this.endpoint!="string")throw new TypeError("endpoint must be defined as a string or a function that returns a promise");if(!(this.file instanceof File))throw new TypeError("file must be a File object");if(this.headers&&typeof this.headers!="function"&&typeof this.headers!="object")throw new TypeError("headers must be null, an object, or a function that returns an object or a promise");if(!U(this.chunkSize,{maxChunkSize:this.maxChunkSize,minChunkSize:this.minChunkSize}))throw D(this.chunkSize,{maxChunkSize:this.maxChunkSize,minChunkSize:this.minChunkSize});if(this.maxChunkSize&&(typeof this.maxChunkSize!="number"||this.maxChunkSize<256||this.maxChunkSize%256!==0||this.maxChunkSize<this.chunkSize||this.maxChunkSize<this.minChunkSize))throw new TypeError(`maxChunkSize must be a positive number in multiples of 256, and larger than or equal to both ${this.minChunkSize} and ${this.chunkSize}`);if(this.minChunkSize&&(typeof this.minChunkSize!="number"||this.minChunkSize<256||this.minChunkSize%256!==0||this.minChunkSize>this.chunkSize||this.minChunkSize>this.maxChunkSize))throw new TypeError(`minChunkSize must be a positive number in multiples of 256, and smaller than ${this.chunkSize} and ${this.maxChunkSize}`);if(this.maxFileBytes>0&&this.maxFileBytes<this.file.size)throw new Error(`file size exceeds maximum (${this.file.size} > ${this.maxFileBytes})`);if(this.attempts&&(typeof this.attempts!="number"||this.attempts<=0))throw new TypeError("retries must be a positive number");if(this.delayBeforeAttempt&&(typeof this.delayBeforeAttempt!="number"||this.delayBeforeAttempt<0))throw new TypeError("delayBeforeAttempt must be a positive number")}getEndpoint(){return typeof this.endpoint=="string"?(this.endpointValue=this.endpoint,Promise.resolve(this.endpoint)):this.endpoint(this.file).then(e=>(this.endpointValue=e,this.endpointValue))}xhrPromise(e){const t=n=>{n.upload.onprogress=r=>{var s;const i=this.totalChunks-this.chunkCount,o=(this.file.size-this.nextChunkRangeStart)/this.file.size/i,f=r.loaded/((s=r.total)!=null?s:this.chunkByteSize)*o;this.dispatch("progress",Math.min((this.successfulPercentage+f)*100,100))}};return new Promise((n,r)=>{this.currentXhr=(0,sn.default)({...e,beforeSend:t},(s,i)=>(this.currentXhr=void 0,s?r(s):n(i)))})}async sendChunk(e){const t=this.nextChunkRangeStart,n=t+e.size-1,s={...await(typeof this.headers=="function"?this.headers():this.headers),"Content-Type":this.file.type,"Content-Range":`bytes ${t}-${n}/${this.file.size}`};return this.dispatch("attempt",{chunkNumber:this.chunkCount,totalChunks:this.totalChunks,chunkSize:this.chunkSize}),this.xhrPromise({headers:s,url:this.endpointValue,method:this.method,body:e})}async sendChunkWithRetries(e){const t=async(o,l)=>{var f;const h=(new Date().getTime()-this.lastChunkStart.getTime())/1e3;if(this.dispatch("chunkSuccess",{chunk:this.chunkCount,chunkSize:this.chunkSize,attempts:this.attemptCount,timeInterval:h,response:o}),this.attemptCount=0,this.chunkCount=((f=this.chunkCount)!=null?f:0)+1,this.nextChunkRangeStart=this.nextChunkRangeStart+this.chunkByteSize,this.dynamicChunkSize){let y=this.chunkSize;h<10?y=Math.min(this.chunkSize*2,this.maxChunkSize):h>30&&(y=Math.max(this.chunkSize/2,this.minChunkSize)),this.chunkSize=Math.ceil(y/256)*256;const S=(this.file.size-this.nextChunkRangeStart)/this.chunkByteSize;this.totalChunks=Math.ceil(this.chunkCount+S)}return!0},n=async(o,l)=>(this.dispatch("progress",Math.min(this.successfulPercentage*100,100)),this.dispatch("error",{message:`Server responded with ${o.statusCode}. Stopping upload.`,chunk:this.chunkCount,attempts:this.attemptCount,response:o}),!1),r=async(o,l)=>(this.dispatch("attemptFailure",{message:`An error occured uploading chunk ${this.chunkCount}. ${this.attempts-this.attemptCount} retries left.`,chunkNumber:this.chunkCount,attemptsLeft:this.attempts-this.attemptCount,response:o}),new Promise(f=>{setTimeout(async()=>{if(this._paused||this.offline){this.pendingChunk=e,f(!1);return}const c=await this.sendChunkWithRetries(e);f(c)},this.delayBeforeAttempt*1e3)}));let s;try{this.attemptCount=this.attemptCount+1,this.lastChunkStart=new Date,s=await this.sendChunk(e)}catch(o){typeof(o==null?void 0:o.statusCode)=="number"&&(s=o)}const i={retryCodes:this.retryCodes,attemptCount:this.attemptCount,attempts:this.attempts,currentChunkEndByte:this.nextChunkRangeStart+e.size-1};return hn(s,i)?r(s):$e(s)?t(s):dn(s,i)?n(s):r(s)}async sendChunks(){if(this.pendingChunk&&!(this._paused||this.offline)){const e=this.pendingChunk;this.pendingChunk=void 0;const t=await this.sendChunkWithRetries(e);this.success&&t&&this.dispatch("success")}for(;!(this.success||this._paused||this.offline);){const{value:e,done:t}=await this.chunkedIterator.next();let n=!e&&t;if(e&&(n=await this.sendChunkWithRetries(e)),this.chunkedIterable.error){n=!1,this.dispatch("error",{message:`Unable to read file of size ${this.file.size} bytes. Try loading from another browser.`});return}if(this.success=!!t,this.success&&n&&this.dispatch("success"),!n)return}}};function fn(e){return He.createUpload(e)}const pn={class:"grid w-full"},mn={class:"flex flex-col"},gn={class:"grid flex-1 gap-4 overflow-auto p-4 lg:grid-cols-3"},vn={class:"relative flex-col items-start gap-8 md:flex"},yn={class:"grid gap-6 rounded-lg border p-4"},bn=u("legend",{class:"-ml-1 px-1 text-sm font-medium"},"Submission info",-1),_n={class:"grid gap-3"},kn={key:0,class:"space-y-2"},Cn={class:"h-3 overflow-hidden rounded bg-gray-100 shadow-inner"},Sn={class:"flex items-center justify-between"},wn={class:"flex items-center space-x-2"},En={class:"text-sm"},Rn={key:0,class:"text-sm"},zn={class:"grid gap-3"},xn={class:"grid gap-3"},Tn={class:"grid gap-6 rounded-lg border p-4"},Pn=u("legend",{class:"-ml-1 px-1 text-sm font-medium"},"Additional info",-1),On={class:"grid gap-3"},In={class:"grid gap-3"},An=u("button",{type:"submit"},"Submit",-1),Bn={class:"relative flex w-full max-w-[100vw] flex-col items-center justify-center rounded-md bg-muted/50 p-2 ring-2 ring-primary lg:col-span-2 lg:p-4"},Ln={class:"relative aspect-video w-full rounded-lg"},jn={key:0,class:"grid aspect-video w-full items-center justify-center"},Un={class:"text-center text-muted-foreground"},Dn=u("p",null,"No video",-1),Jn=we({__name:"Upload",setup(e){const t=Ke();Je({});const n=re(null),r=re(null),s={file:null,uploader:null,progress:0,uploading:!1,error:null},i=Ye({...s,formattedProgress:Ze(()=>Math.round(i.progress)),reset:()=>{Object.assign(i,s)}}),o=()=>{var c;(c=i.uploader)==null||c.abort(),i.reset&&i.reset()},l=c=>{let h=new FileReader;if(c&&r){h.readAsArrayBuffer(c),h.onload=function(y){var a;let S=(a=y.target)==null?void 0:a.result;if(S&&S instanceof ArrayBuffer){let p=new Blob([new Uint8Array(S)],{type:"video/mp4"}),v=window.URL.createObjectURL(p);r.value?r.value.src=v:console.error("videoPlayer is null when trying to set src")}else console.error("Unexpected buffer type:",S)};return}r&&(r.value?r.value.src="":console.error("videoPlayer is null when trying to set src"))};Qe(n,c=>{i.file=c,l(c)});const f=()=>{i.file&&(i.file=i.file),i.file&&(i.uploader=fn({endpoint:route("test-upload.advance"),headers:{"X-CSRF-TOKEN":t.props.csrf_token},method:"POST",file:i.file,chunkSize:50*1024}),i.uploader.on("attempt",()=>{i.error=null,i.uploading=!0}),i.uploader.on("progress",c=>{i.progress=c.detail}),i.uploader.on("success",()=>{i.reset}),i.uploader.on("error",c=>{i.error=c.detail.message}))};return(c,h)=>(k(),et(ct,null,{default:x(()=>[_(b(tt),{title:"Upload test page"}),u("div",pn,[u("div",mn,[u("main",gn,[_(b(ft),{class:"rounded-md border ring-2 max-lg:order-1 lg:h-[78vh]"},{default:x(()=>{var y,S;return[u("div",vn,[u("form",{onSubmit:nt(f,["prevent"]),class:"grid w-full items-start gap-6 overflow-auto p-2 lg:p-4"},[u("fieldset",yn,[bn,u("div",_n,[_(b(j),null,{default:x(()=>[I("Upload File")]),_:1}),_(Et,{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=a=>n.value=a)},null,8,["modelValue"]),i.uploading?(k(),C("div",kn,[u("div",Cn,[u("div",{class:"h-full bg-blue-500 transition-all duration-200",style:rt({width:i.progress+"%"})},null,4)]),u("div",Sn,[u("div",wn,[(y=i.uploader)!=null&&y.paused?B("",!0):(k(),C("button",{key:0,class:"text-sm text-indigo-500",onClick:h[1]||(h[1]=a=>{var p;return(p=i.uploader)==null?void 0:p.pause()})}," Pause ")),(S=i.uploader)!=null&&S.paused?(k(),C("button",{key:1,class:"text-sm text-indigo-500",onClick:h[2]||(h[2]=a=>{var p;return(p=i.uploader)==null?void 0:p.resume()})}," Resume ")):B("",!0),u("button",{class:"text-sm text-indigo-500",onClick:o}," Cancel ")]),u("div",En,se(i.formattedProgress)+"%",1)]),i.error?(k(),C("div",Rn,se(i.error),1)):B("",!0)])):B("",!0)]),u("div",zn,[_(b(j),{for:"judul"},{default:x(()=>[I("Judul")]),_:1}),_(b(me),{id:"judul",placeholder:"ex: GDSCHOOLICIOUS_NAMA SEKOLAH_KOTA ASAL"})]),u("div",xn,[_(b(j),{for:"instagram_reels"},{default:x(()=>[I("link URL Instagram Reels :")]),_:1}),_(b(me),{id:"instagram_reels",placeholder:"ex: https://www.instagram.com/reel/C68td6fyyzsM/?hl=en"})])]),u("fieldset",Tn,[Pn,u("div",On,[_(b(j),{for:"role"},{default:x(()=>[I("Upload Thumbnail video")]),_:1}),_(at)]),u("div",In,[_(b(j),{for:"description"},{default:x(()=>[I("Description")]),_:1}),_(b(lt),{id:"description",placeholder:"ex: Temukan Harmoni indah dalam lagu 'Rasa di Ujung Senda' dengan lirik penuh makna dan melodi yang menenagkan",class:"min-h-[9.5rem]"})])]),An],32)])]}),_:1}),u("div",Bn,[st(u("div",Ln,[_(b(ot),{variant:"outline",class:"absolute right-4 top-4 z-1 bg-muted opacity-50"},{default:x(()=>[I(" Video Preview ")]),_:1}),u("video",{draggable:"false",ref_key:"videoPlayer",ref:r,id:"video-preview",class:"aspect-video w-full rounded-lg",controls:""},null,512)],512),[[it,i.file]]),i.file?B("",!0):(k(),C("div",jn,[u("div",Un,[_(b(ut),{class:"size-full"}),Dn])]))])])])])]),_:1}))}});export{Jn as default};
