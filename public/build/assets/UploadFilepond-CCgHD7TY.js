import{d as T,x as v,Q as O,T as D,h as $,w as a,o as _,f as t,u as o,Z as C,b as l,i as N,g as u,c as x,I as z,t as L,j as b,l as M,D as E}from"./app-QodTeFZz.js";import{_ as c,a as H}from"./index-BW379UGd.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-BoOU5wAp.js";import{_ as K}from"./Textarea.vue_vue_type_script_setup_true_lang-CE3hzSFb.js";import{_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-BW-Uk1ZR.js";import{_ as J}from"./ScrollArea.vue_vue_type_script_setup_true_lang-4SurwzRX.js";import{v as Q,a as X,p as Z,b as q,s as W}from"./filepond-plugin-file-validate-size.esm-BdWSUhgI.js";import{V as Y}from"./video-off-CU-Nb2kx.js";import"./index-BX9TLIVG.js";import"./utils-BuzIblbe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-BIY99D_V.js";import"./ApplicationLogo-aprdaqZi.js";const ee={class:"grid w-full"},le={class:"flex flex-col"},oe={class:"grid flex-1 gap-4 overflow-auto p-4 lg:grid-cols-3"},se={class:"relative flex-col items-start gap-8 md:flex"},ie={class:"grid gap-6 rounded-lg border p-4"},te=l("legend",{class:"-ml-1 px-1 text-sm font-medium"}," Submission info ",-1),ne={class:"grid gap-3"},ae={key:0,class:"space-y-2"},re={class:"h-3 overflow-hidden rounded bg-gray-100 shadow-inner"},de={class:"flex items-center justify-between"},ue=l("div",{class:"flex items-center space-x-2"},null,-1),ce={class:"text-sm"},fe={class:"grid gap-3"},pe={class:"grid gap-3"},me={class:"grid gap-6 rounded-lg border p-4"},ve=l("legend",{class:"-ml-1 px-1 text-sm font-medium"}," Additional info ",-1),_e={class:"grid gap-3"},ge={class:"grid gap-3"},he=l("button",{type:"submit"},"Submit",-1),we={class:"relative flex w-full max-w-[100vw] flex-col items-center justify-center rounded-md bg-muted/50 p-2 ring-2 ring-primary lg:col-span-2 lg:p-4"},ye={class:"relative aspect-video w-full rounded-lg"},xe={key:0,class:"grid aspect-video w-full items-center justify-center"},be={class:"text-center text-muted-foreground"},Ve=l("p",null,"No video",-1),Ce=T({__name:"UploadFilepond",setup(Fe){const f=v(!1),F=O(),i=D({video:null,thumbnail:null,judulVideo:"",linkIg:"",videoDescription:""}),p=v(null),m=v(null),r=v(null),g=s=>{let e=new FileReader;if(s&&r){e.readAsArrayBuffer(s),e.onload=function(n){var y;let d=(y=n.target)==null?void 0:y.result;if(d&&d instanceof ArrayBuffer){let j=new Blob([new Uint8Array(d)],{type:"video/mp4"}),B=window.URL.createObjectURL(j);r.value?r.value.src=B:console.error("videoPlayer is null when trying to set src")}else console.error("Unexpected buffer type:",d)};return}r&&(r.value?r.value.src="":console.error("videoPlayer is null when trying to set src"))};async function I(){var n,d;const s=await((n=p.value)==null?void 0:n.processFile()),e=await((d=m.value)==null?void 0:d.processFile());return s!=null&&s.serverId&&(console.log("videoProcessed"),console.log(s),i.video=s==null?void 0:s.serverId),e!=null&&e.serverId&&(console.log(e),i.thumbnail=e==null?void 0:e.serverId),(s==null?void 0:s.serverId)&&(e==null?void 0:e.serverId)}async function k(){await I()?i.put(route("test-upload.uploadFilepond"),{onSuccess:()=>{console.log("upload success"),p.value&&p.value.removeFiles(),m.value&&m.value.removeFiles()}}):console.error("File processing failed")}const h=Q(q,Z,X),w=()=>{W({credits:!1,allowMultiple:!1,instantUpload:!1,allowProcess:!1,server:{url:"/filepond",headers:{"X-CSRF-TOKEN":F.props.csrf_token}}})},U=(s,e)=>{i.video=e.serverId},A=(s,e)=>{g(e.file),f.value=!0},P=(s,e)=>{i.video=null,g(null),f.value=!1},S=(s,e)=>{i.thumbnail=e.serverId},R=(s,e)=>{i.thumbnail=null};return(s,e)=>(_(),$(G,null,{default:a(()=>[t(o(C),{title:"Upload test page"}),l("div",ee,[l("div",le,[l("main",oe,[t(o(J),{class:"rounded-md border ring-2 max-lg:order-1 lg:h-[78vh]"},{default:a(()=>[l("div",se,[l("form",{onSubmit:N(k,["prevent"]),class:"grid w-full items-start gap-6 overflow-auto p-2 lg:p-4"},[l("fieldset",ie,[te,l("div",ne,[t(o(c),null,{default:a(()=>[u("Upload File")]),_:1}),t(o(h),{name:"video",credits:"false","max-file-size":"250MB",ref_key:"filepondVideoInput",ref:p,"chunk-upload":"true","accepted-file-types":"video/*",onInit:w,onProcessfile:U,onAddfile:A,onRemovefile:P},null,8,["onProcessfile","onAddfile","onRemovefile"]),o(i).progress?(_(),x("div",ae,[l("div",re,[l("div",{class:"h-full bg-blue-500 transition-all duration-200",style:z({width:o(i).progress.percentage+"%"})},null,4)]),l("div",de,[ue,l("div",ce,L(o(i).progress.percentage)+"% ",1)])])):b("",!0)]),l("div",fe,[t(o(c),{for:"judul"},{default:a(()=>[u("Judul")]),_:1}),t(o(V),{id:"judul",modelValue:o(i).judulVideo,"onUpdate:modelValue":e[0]||(e[0]=n=>o(i).judulVideo=n),placeholder:"ex: GDSCHOOLICIOUS_NAMA SEKOLAH_KOTA ASAL"},null,8,["modelValue"])]),l("div",pe,[t(o(c),{for:"instagram_reels"},{default:a(()=>[u("link URL Instagram Reels :")]),_:1}),t(o(V),{modelValue:o(i).linkIg,"onUpdate:modelValue":e[1]||(e[1]=n=>o(i).linkIg=n),id:"instagram_reels",placeholder:"ex: https://www.instagram.com/reel/C68td6fyyzsM/?hl=en"},null,8,["modelValue"])])]),l("fieldset",me,[ve,l("div",_e,[t(o(c),{for:"role"},{default:a(()=>[u("Upload Thumbnail video")]),_:1}),t(o(h),{name:"thumbnail",credits:"false","max-file-size":"2MB",ref_key:"filepondThumbnailInput",ref:m,"accepted-file-types":"image/jpeg, image/png",onInit:w,onProcessfile:S,onRemovefile:R},null,8,["onProcessfile","onRemovefile"])]),l("div",ge,[t(o(c),{for:"description"},{default:a(()=>[u("Description")]),_:1}),t(o(K),{id:"description",modelValue:o(i).videoDescription,"onUpdate:modelValue":e[2]||(e[2]=n=>o(i).videoDescription=n),placeholder:"ex: Temukan Harmoni indah dalam lagu 'Rasa di Ujung Senda' dengan lirik penuh makna dan melodi yang menenagkan",class:"min-h-[9.5rem]"},null,8,["modelValue"])])]),he],32)])]),_:1}),l("div",we,[M(l("div",ye,[t(o(H),{variant:"outline",class:"absolute right-4 top-4 z-1 bg-muted opacity-50"},{default:a(()=>[u(" Video Preview ")]),_:1}),l("video",{draggable:"false",ref_key:"videoPlayer",ref:r,id:"video-preview",class:"aspect-video w-full rounded-lg",controls:""},null,512)],512),[[E,f.value]]),f.value?b("",!0):(_(),x("div",xe,[l("div",be,[t(o(Y),{class:"size-full"}),Ve])]))])])])])]),_:1}))}});export{Ce as default};
